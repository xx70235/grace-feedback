<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Welcome</title>

    <!-- Bootstrap -->
      <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
      <link rel="stylesheet" href="{{ url_for('static', filename='css/font-awesome.min.css') }}">
      <script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body background="../static/img/background.jpg">

      <div class="container">

          <div class="container hidden">
          <label id="sign">{{ sign }}</label>
        </div>

        <div class="modal-dialog" style="margin-top: 10%;">
            <div class="modal-content">
                <div class="modal-header">

                    <h4 class="modal-title text-center" id="myModalLabel">set plugin config</h4>
                </div>
                <div class="modal-body" id = "model-body">
                    <div class="form-group hidden">
                        <input type="text" class="form-control" placeholder="account" id="account" value={{ account }} autocomplete="off">
                    </div>
                    <div class="form-group hidden">
                        <input type="text" class="form-control" placeholder="account" id="password_old" value={{ password_old }} autocomplete="off">
                    </div>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="set the shop email for costumer contact" id="email" autocomplete="off">
                    </div>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="set the contact us page url example: https://www.shop/pages/contact-us" id="contact_us" autocomplete="off">
                    </div>
                    <div class="form-group">
                        <input type="password" class="form-control" placeholder="set your new password" id="password_new" autocomplete="off">
                    </div>
                    <div class="form-group">
                        <input type="password" class="form-control" placeholder="new password confirmation" id="password_new_con" autocomplete="off">
                    </div>

                </div>
                <div class="modal-footer">
                    <div class="form-group">
                        <button type="button" id="set-button" class="btn btn-primary form-control">set</button>
                    </div>
                    <div class="form-group">
                        <p><strong>Note: if you set the configs value to be null, it won't be updated</strong></p>
                    </div>

                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
          <script>
            jQuery(document).ready(function () {
                var label_sign = document.getElementById("sign");
                var sign = label_sign.innerText.trim();
                if(sign === "no_email"){
                    alert("email address is not valid")
                }else if(sign === "no_url"){
                    alert("contact-us url is not vaild")
                }else if(sign === "error"){
                    alert("the server has something error")
                }

                $('#set-button').click(function () {
                    var account = $("#account").val();
                    var email = $('#email').val();
                    var contact_us = $('#contact_us').val()
                    var password_old = $("#password_old").val();
                    var password_new = $("#password_new").val();
                    var password_new_con = $("#password_new_con").val();

                    if(password_new !== password_new_con){
                        alert("twice input of new password is not the same!")
                        return
                    }


                    var data = {
                        "account": account,
                        "password_old": password_old,
                        "password_new": password_new,
                        "email":  email,
                        "contact_url": contact_us
                    }
                    $.ajax({
                        url: "https://www.ycadvisor.com/set_config",
                        type: "post",
                        data: JSON.stringify(data),
                        contentType: "application/json;charset=UTF-8",
                        dataType: "html",
                        success: function(data){
                            document.write(data)
                            document.close()
                        }
                    });
                });

            });
        </script>



      </div>



  </body>
</html>